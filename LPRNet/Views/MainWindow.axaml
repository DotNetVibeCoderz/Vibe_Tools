<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:LPRNet.ViewModels"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
        x:Class="LPRNet.Views.MainWindow"
        x:DataType="vm:MainViewModel"
        Title="LPRNet - License Plate Recognition System">

    <Design.DataContext>
        <vm:MainViewModel/>
    </Design.DataContext>

    <Grid ColumnDefinitions="*, 300" Margin="10">
        <!-- Left Panel: Camera/Preview -->
        <Grid Grid.Column="0" RowDefinitions="Auto, *, Auto" Margin="0,0,10,0">
            <TextBlock Text="Live Camera Feed / Image Source" FontWeight="Bold" FontSize="16" Margin="0,0,0,10"/>
            
            <Border Grid.Row="1" BorderBrush="Gray" BorderThickness="1" Background="#202020" CornerRadius="4">
                <Image Source="{Binding PreviewImage}" Stretch="Uniform"/>
            </Border>

            <StackPanel Grid.Row="2" Orientation="Horizontal" Margin="0,10,0,0" Spacing="10">
                <Button Name="BtnOpenFile" Content="Open File (Img/Video)" 
                        Click="OnOpenFileClick"
                        Background="#28A745" Foreground="White" Padding="15,8"/>
                
                <Button Command="{Binding CaptureCommand}" Content="Mockup / Simulation" 
                        Background="#007ACC" Foreground="White" Padding="15,8"/>
                
                <TextBlock Text="{Binding StatusMessage}" VerticalAlignment="Center" Foreground="Gray" Margin="10,0,0,0"/>
            </StackPanel>
        </Grid>

        <!-- Right Panel: Logs & Search -->
        <Grid Grid.Column="1" RowDefinitions="Auto, *">
            <StackPanel Grid.Row="0" Margin="0,0,0,10">
                <TextBlock Text="Recognition Log" FontWeight="Bold" FontSize="16" Margin="0,0,0,5"/>
                <TextBox Text="{Binding SearchQuery}" Watermark="Search Plate..." Margin="0,0,0,5"/>
                <Grid ColumnDefinitions="*, 5, Auto">
                    <Button Grid.Column="0" Command="{Binding SearchCommand}" Content="Filter Logs" HorizontalAlignment="Stretch"/>
                    <Button Grid.Column="2" Command="{Binding ClearLogsCommand}" Content="Clear Log" Background="#DC3545" Foreground="White"/>
                </Grid>
            </StackPanel>

            <Border Grid.Row="1" BorderBrush="Gray" BorderThickness="1" CornerRadius="4">
                <ListBox ItemsSource="{Binding Logs}" Background="White">
                    <ListBox.ItemTemplate>
                        <DataTemplate>
                            <Border BorderBrush="#EEEEEE" BorderThickness="0,0,0,1" Padding="5">
                                <Grid ColumnDefinitions="*, Auto">
                                    <StackPanel Grid.Column="0">
                                        <TextBlock Text="{Binding PlateNumber}" Foreground="Black" FontWeight="Bold" FontSize="14"/>
                                        <TextBlock Text="{Binding Timestamp}" FontSize="11" Foreground="Gray"/>
                                    </StackPanel>
                                    <StackPanel Grid.Column="1" HorizontalAlignment="Right">
                                        <TextBlock Text="{Binding Confidence, StringFormat={}{0:P0}}" 
                                                   Foreground="Green" FontWeight="Bold"/>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>
            </Border>
        </Grid>
    </Grid>

</Window>